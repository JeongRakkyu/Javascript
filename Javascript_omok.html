<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
        </style>
    </head>
    <body>
        <input type="text" id="stone">
        <button onclick="omokk()">좌표 입력</button>
        <button onclick="refresh()">재시작</button>
        <p>* 좌표입력 시 주의사항 : xx,yy의 형태로 입력할 것(ex. 3,5 => 03,05) / 숫자는 00 ~ 15까지</p>
        <p id="output"></p>
        <script>
            //배열 설정//
            var omok = [];
            for(var row = 0; row < 16; row++) {
                omok[row] = [" □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", " □ ", "<br>"];
            }

            var output = "";
            for(var row = 0; row < 16; row++) {
                for(var col = 0; col < 17; col++) {
                    output = output + omok[row][col];
                }
            }
            document.getElementById("output").innerHTML = output;

            var stone = " ● ";
            var block_stone = " ○ ";
            var stone_switch = 0;
            var cnt_end = 0;//종료 카운터 16x16 => 256일 때 종료 => 새로고침 선택지 줘야함//
            function refresh() {                    //새로고침 실험용, 필요 시 새로고침//
                if(confirm("정말로 다시 시작하시겠습니까?")) {
                    location.reload(); 
                }
            }
            function omokk() {
                //좌표 변수 : coordinate(인풋창 string, 전체 좌표), x(행좌표), y(열좌표)//
                var coordinate = document.getElementById("stone").value;
                var x = parseInt(coordinate.charAt(0) + coordinate.charAt(1));
                var y = parseInt(coordinate.charAt(3) + coordinate.charAt(4));



                //범위 이탈 방지//
                var check_same = 0;                         //동일위치 시 반복 중지//
                var check_over = 0;                         //범위이탈 시 반복 중지//
                if(x >= 0 && x <= 15 && y >= 0 && y <= 15) {
                    //중복좌표 입력 방지//
                    if (omok[x][y] !== " □ ") {
                        window.alert(stone + "과 동일한 위치입니다. 다시 좌표를 입력해주세요.");
                        check_same = 1;
                    } else {
                        if (stone_switch === 0) {
                            stone = " ● ";
                            block_stone = " ○ ";
                            stone_switch = 1;
                        } else {
                            stone = " ○ ";
                            block_stone = " ● ";
                            stone_switch = 0;
                        }
                    }
                    //중복좌표 입력 방지 종료//

                    omok[x][y] = stone;                                     //돌 입력//

                } else {
                    window.alert("바둑판의 범위를 벗어났습니다. 다시 좌표를 입력해주세요.");
                    if(cnt_end === 0) {
                        stone_switch = 0;                                       //처음일 경우 흰돌로 바뀌는 현상이 존재//
                    } else {
                        stone_switch = 1 - stone_switch;                        //stone_switch 원복//
                    }
                    check_over = 1;
                }
                //범위 이탈 방지 종료//

                /*while(true) {

                    if(y === 16) {
                        if(x >= 0 && x <= 15) {

                            break;
                        }
                    } else if()
                    if(x < 0 || x > 15){
                        if(y > 15) {
                            window.alert("바둑판의 범위를 벗어났습니다. 다시 좌표를 입력해주세요.");
                            omok[x][y] = "<br>";
                            stone_switch = 1 - stone_switch;                        //stone_switch 원복//
                            break_switch = 1;
                            break;
                        }
                    }
                    if(x < 0 || x > 15 || y < 0 || y > 15) {            //y > 15 => <br>, 나머지 => 아무동작x 로 바꿔야됨//
                    window.alert("바둑판의 범위를 벗어났습니다. 다시 좌표를 입력해주세요.");
                    omok[x][y] = "<br>";
                    stone_switch = 1 - stone_switch;                        //stone_switch 원복//
                    break_switch = 1;
                    break;
                    } else {
                        break;
                    }
                }*/

                while(true) {
                    if(check_same === 1 || check_over === 1) {
                        break;
                    }
                    //승리변수//
                    var cnt_win_1 = 0;
                    var cnt_win_2 = 0;
                    var cnt_win_3 = 0;
                    var cnt_win_4 = 0;
                    //삼삼변수//
                    var cnt_3x3_1 = 0;
                    var cnt_3x3_2 = 0;
                    var cnt_3x3_3 = 0;
                    var cnt_3x3_4 = 0;
                    //삼삼블락//
                    var cnt_3x3_block_1 = 0;
                    var cnt_3x3_block_2 = 0;
                    var cnt_3x3_block_3 = 0;
                    var cnt_3x3_block_4 = 0;

                    //상하 승리, 삼삼변수 증가//
                    for(var i = 1; i < 16; i++) {
                        if(x - i < 0) {
                            cnt_3x3_block_1++;
                            break;              //33블락 추가해봐 벽에 붙었을 때 33막히는거 안됨//
                        } else {
                            if(omok[x][y] === omok[x - i][y]) {
                                cnt_win_1++;
                                cnt_3x3_1++;
                            } else {
                                if(omok[x - i][y] === block_stone) {
                                    cnt_3x3_block_1++;
                                    break;
                                } else {
                                    break;
                                }
                            }
                        }
                    }

                    for(var i = 1; i < 16; i++) {
                        if(x + i > 15) {
                            cnt_3x3_block_1++;
                            break;
                        } else {
                            if(omok[x][y] === omok[x + i][y]) {
                                cnt_win_1++;
                                cnt_3x3_1++;
                            } else {
                                if(omok[x + i][y] === block_stone) {
                                    cnt_3x3_block_1++;
                                    break;
                                } else {
                                    break;
                                }
                            }
                        }
                    }
                    //상하 승리, 삼삼변수 증가 종료//

                    //좌우 승리, 삼삼변수 증가//
                    for(var i = 1; i < 16; i++) {
                        if(y - i < 0) {
                            cnt_3x3_block_2++;
                            break;
                        } else {
                            if(omok[x][y] === omok[x][y - i]) {
                                cnt_win_2++;
                                cnt_3x3_2++;
                            } else {
                                if(omok[x][y - i] === block_stone) {
                                    cnt_3x3_block_2++;
                                    break;
                                } else {
                                    break;
                                }
                            }
                        }
                    }

                    for(var i = 1; i < 16; i++) {
                        if(y + i > 15) {
                            cnt_3x3_block_2++;
                            break;
                        } else {
                            if(omok[x][y] === omok[x][y + i]) {
                                cnt_win_2++;
                                cnt_3x3_2++;
                            } else {
                                if(omok[x][y + i] === block_stone) {
                                    cnt_3x3_block_2++;
                                    break;
                                } else {
                                    break;
                                }
                            }
                        }
                    }
                    //좌우 승리, 삼삼변수 증가 종료//

                    //좌상우하 승리, 삼삼변수 증가//
                    for(var i = 1; i < 16; i++) {
                        if(x - i < 0 || y - i < 0) {
                            cnt_3x3_block_3++;
                            break;
                        } else {
                            if(omok[x][y] === omok[x - i][y - i]) {
                                cnt_win_3++;
                                cnt_3x3_3++;
                            } else {
                                if(omok[x - i][y - i] === block_stone) {
                                    cnt_3x3_block_3++;
                                    break;
                                } else {
                                    break;
                                }
                            }
                        }
                    }

                    for(var i = 1; i < 16; i++) {
                        if(x + i > 15 || y + i > 15) {
                            cnt_3x3_block_3++;
                            break;
                        } else {
                            if(omok[x][y] === omok[x + i][y + i]) {
                                cnt_win_3++;
                                cnt_3x3_3++;
                            } else {
                                if(omok[x + i][y + i] === block_stone) {
                                    cnt_3x3_block_3++;
                                    break;
                                } else {
                                    break;
                                }
                            }
                        }
                    }
                    //좌상우하 승리, 삼삼변수 증가 종료//

                    //우상좌하 승리, 삼삼변수 증가//
                    for(var i = 1; i < 16; i++) {
                        if(x - i < 0 || y + i > 15) {
                            cnt_3x3_block_4++;
                            break;
                        } else {
                            if(omok[x][y] === omok[x - i][y + i]) {
                                cnt_win_4++;
                                cnt_3x3_4++;
                            } else {
                                if(omok[x - i][y + i] === block_stone) {
                                    cnt_3x3_block_4++;
                                    break;
                                } else {
                                    break;
                                }
                            }
                        }
                    }

                    for(var i = 1; i < 16; i++) {
                        if(x + i > 15 || y - i < 0) {
                            cnt_3x3_block_4++;
                            break;
                        } else {
                            if(omok[x][y] === omok[x + i][y - i]) {
                                cnt_win_4++;
                                cnt_3x3_1++;
                            } else {
                                if(omok[x + i][y - i] === block_stone) {
                                    cnt_3x3_block_4++;
                                    break;
                                } else {
                                    break;
                                }
                            }
                        }
                    }
                    //우상좌하 승리, 삼삼변수 증가 종료//

                    //삼삼확인 -- 한군데라도 막혀있을 때 삼삼아니라고 만들어야됨 네모아니고 stone아닐 때 블락변수 1추가 => 1이거나 2일 때 삼삼 아님(break 해버리면 됨)//
                    var check_3x3 = 0;
                    while(true) {
                        //기본 삼삼조건 확인 : 바둑돌 놓았을 때, 그 위치 기준으로 삼인 것이 2개 이상//
                        if(cnt_3x3_1 === 2 && cnt_3x3_2 !== 2 && cnt_3x3_3 !== 2 && cnt_3x3_4 !== 2) {
                            break;
                        } else if(cnt_3x3_1 !== 2 && cnt_3x3_2 === 2 && cnt_3x3_3 !== 2 && cnt_3x3_4 !== 2){
                            break;
                        } else if(cnt_3x3_1 !== 2 && cnt_3x3_2 !== 2 && cnt_3x3_3 === 2 && cnt_3x3_4 !== 2){
                            break;
                        } else if(cnt_3x3_1 !== 2 && cnt_3x3_2 !== 2 && cnt_3x3_3 !== 2 && cnt_3x3_4 === 2){
                            break;
                        } else if(cnt_3x3_1 !== 2 && cnt_3x3_2 !== 2 && cnt_3x3_3 !== 2 && cnt_3x3_4 !== 2){
                            break;
                        } else {
                            //기본 삼삼조건을 만족한 상태에서 2개 이상 안막혔을 경우 삼삼 인정//
                            if(cnt_3x3_block_1 !== 0 && cnt_3x3_block_2 !== 0 && cnt_3x3_block_3 !== 0 && cnt_3x3_block_3 !== 0) {
                                break;
                            } else if(cnt_3x3_block_1 === 0 && cnt_3x3_block_2 !== 0 && cnt_3x3_block_3 !== 0 && cnt_3x3_block_3 !== 0){
                                break;
                            } else if(cnt_3x3_block_1 !== 0 && cnt_3x3_block_2 === 0 && cnt_3x3_block_3 !== 0 && cnt_3x3_block_3 !== 0){
                                break;
                            } else if(cnt_3x3_block_1 !== 0 && cnt_3x3_block_2 !== 0 && cnt_3x3_block_3 === 0 && cnt_3x3_block_3 !== 0){
                                break;
                            } else if(cnt_3x3_block_1 !== 0 && cnt_3x3_block_2 !== 0 && cnt_3x3_block_3 !== 0 && cnt_3x3_block_3 === 0){
                                break;
                            } else {
                                omok[x][y] = " □ ";
                                window.alert(stone + "삼삼입니다. 다시 좌표를 입력해주세요.");
                                stone_switch = 1 - stone_switch;                                                        //바둑돌 원복//
                                check_3x3 = 33;
                                break;
                            }
                        }
                    }
                    //삼삼확인 종료//
                    
                    if(check_3x3 === 33) {
                        break;
                    }

                    //정상일 경우 바둑돌 출력//
                    output = "";
                    for(var row = 0; row < 16; row++) {
                        for(var col = 0; col < 17; col++) {
                            output = output + omok[row][col];
                        }
                    }
                    document.getElementById("output").innerHTML = output;
                    //출력 종료//

                    cnt_end++;//정상 출력 시 종료카운터 1증가//
                    console.log(cnt_end);

                    //승리확인//
                    if(cnt_win_1 === 4) {
                        window.alert(stone + "W I N !");
                    } else if(cnt_win_2 === 4) {
                        window.alert(stone + "W I N !");
                    } else if(cnt_win_3 === 4) {
                        window.alert(stone + "W I N !");
                    } else if(cnt_win_4 === 4) {
                        window.alert(stone + "W I N !");
                    }
                    //승리확인 종료//

                    if(cnt_end === 256) {
                        if(confirm("바둑판에 더 이상 둘 곳이 없습니다.\n다시 시작하시겠습니까?")) {
                            location.reload();
                        } else {
                            break;
                        }
                    }

                    break;
                }
            }

        </script>
    </body>
</html>